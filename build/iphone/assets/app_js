var SiWriter={},start=1,orientation="null",saved_email_url_file=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"SiWriter_default_email.txt"),saved_file=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"SiWriter.txt"+new Date),last_file=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,"SiWriter.txt"+new Date),previous_contents=saved_file.read(),default_email=saved_email_url_file.read(),dir=Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory),contentTyped="",c=0,s=0,Nums=0,Caps=0,DEL=0,OS_EDIT=0,help_windowSwitch=!1,help_BIGwindowSwitch=!1,help_windowSwitchSetting=!1,Master_Setting_Big_Help=!1,angle={},orient="",props=Titanium.App.Properties.listProperties(),Last_Typed_Word="!?!",Review_mode=0,LRposP=0,LRposL=0,KV=!1,temp="",Toggle=!1,Trigger=!1,oldOrientation="";Ti.API.info(props),Ti.include("KS_email2.js"),Ti.include("buttons.js"),Ti.include("file_saver.js"),Ti.include("OpenHelpWindow.js"),Ti.include("help.js"),Titanium.App.Properties.setString("version",Ti.App.version);var foo=new Date,build_time=foo.getDate()+"/"+foo.getMonth()+"1/"+foo.getFullYear()+" "+foo.getHours()+":"+foo.getMinutes()+":"+foo.getSeconds();build_label.text=build_time,Titanium.App.Properties.setString("date_of_build","\r"+new Date),CheckEmailaddress();var webview=Titanium.UI.createWebView({backgroundColor:"transparent",url:"Keypad.html",height:"60%",disableBounce:!0}),txtViewDesc=Ti.UI.createTextArea({value:"",top:10,backgroundColor:"transparent",font:{fontSize:16},height:"96%"}),view=Ti.UI.createScrollView({backgroundImage:"images/Sized_Screen_lighter.png",borderRadius:10,top:20,left:20,height:720,font:{fontSize:10},opacity:.9}),win1=Titanium.UI.createWindow({title:"SiWriter 1"+new Date,backgroundImage:"images/bg_image.png",height:"100%",bottom:0}),win2=Titanium.UI.createWindow({title:"SiWriter.co.uk Help",backgroundImage:"images/Sized_Screen_lighter.png",height:"100%",bottom:0});Titanium.Platform.displayCaps.platformWidth<Titanium.Platform.displayCaps.platformHeight?(orientation="portrait",Ti.API.info("Launched in PORTRAIT ")):(orientation="landscape",Ti.API.info("Launched in LANDSCAPE ")),webview.addEventListener("beforeload",function(){webview.evalJS("var start='"+start+"';"),webview.evalJS("var HTMLorientation='"+orientation+"';"),start=0});var SiWriter_helpView=Titanium.UI.createWebView({backgroundColor:"transparent",url:"help.html",width:"100%",height:"100%",bottom:0,zIndex:0});Ti.App.removeEventListener("app:sizer_switch",function(){}),Ti.App.addEventListener("app:sizer_switch",function(){sizer_switch.value=!1,Ti.App.fireEvent("sizer_switch_change"),Ti.Media.vibrate()}),recover_settings(),DoOrientation(),removeChildrens(win1),removeChildrens(win2),help_LettersSwitch(),help_bigWindowSwitch(),win2.add(SiWriter_helpView),win2.add(help_windowSwitch),win2.add(help_BIGwindowSwitch),win2.add(help_lettersSwitch),win2.add(help_BIGwindowSwitchLbl),win2.add(help_windowSwitchLbl),win2.add(help_lettersSwitchLbl),win1.add(smallHelpView),win2.add(btnChoosePhoto),win2.add(btnTakePhoto),win2.add(sizer_switch),win2.add(sizer_switchlbl),win1.add(webview),win1.add(view),win1.add(b3),Ti.App.removeEventListener("do_reset",function(){}),Ti.App.addEventListener("do_reset",function(){getOrientation(),Titanium.App.Properties.setString("email_to_setting",aTextField.value),help_WindowSwitcher(),help_LettersSwitch(),help_bigWindowSwitch(),Ti.App.fireEvent("webviewEvent",{text:""})}),help_WindowSwitcher(),win1.open(),view.show(),win1.add(settingsButton),win1.add(copyButton),win1.add(clearButton),win1.add(emailButton),win1.add(pasteButton),win1.add(timeStampButton),top_view.add(aTextField),win1.add(top_view),top_view.add(aTrailer),win1.add(aTrailer),win1.add(version_label),win1.add(build_label),win1.add(PrivacyTitle),1==help_windowSwitch.value?smallHelpView.show():smallHelpView.hide(),help_WindowSwitcher(),smallHelpView.add(smallHelpimages),emailButton.removeEventListener("click",emailCurrentText),clearButton.removeEventListener("click",clearTextFromClipboard),ReviewButton.removeEventListener("click",viewLastText),timeStampButton.removeEventListener("click",timeStamp),copyButton.removeEventListener("click",copyTextToClipboard),pasteButton.removeEventListener("click",pasteTextFromClipboard),settingsButton.removeEventListener("click",settingsButtonAction),returnButton.removeEventListener("click",returnButtonAction),openWebsiteButton.removeEventListener("click",openWebsiteButtonAction),help_windowSwitch.removeEventListener("change",help_WindowSwitcher),help_lettersSwitch.removeEventListener("change",help_LettersSwitch),help_BIGwindowSwitch.removeEventListener("change",help_bigWindowSwitch),emailButton.addEventListener("click",emailCurrentText),clearButton.addEventListener("click",clearTextFromClipboard),ReviewButton.addEventListener("click",viewLastText),timeStampButton.addEventListener("click",timeStamp),copyButton.addEventListener("click",copyTextToClipboard),pasteButton.addEventListener("click",pasteTextFromClipboard),settingsButton.addEventListener("click",settingsButtonAction),returnButton.addEventListener("click",returnButtonAction),openWebsiteButton.addEventListener("click",openWebsiteButtonAction),help_windowSwitch.addEventListener("change",help_WindowSwitcher),help_BIGwindowSwitch.addEventListener("change",help_bigWindowSwitch),help_lettersSwitch.addEventListener("change",help_LettersSwitch),get_MasterSettings(),help_BIGwindowSwitch.addEventListener("change",function(){smallHelpimages.image=1==help_BIGwindowSwitch.value?"/images/BIGAllCodes2.png":"/images/AllCodes.png"}),Ti.Gesture.addEventListener("orientationchange",function(e){return orientation=getOrientation(e.orientation),Ti.App.fireEvent("app:orientation",{orientation:orientation}),"portrait"==orientation&&portrait(),"landscape"==orientation&&landscape(),Ti.API.info("-- App Line 336 ---------------------------------------------------------orientation: "+orientation),orientation}),sizer_switch.removeEventListener("change",function(){}),sizer_switch.addEventListener("change",function(){Ti.App.fireEvent("sizer_switch_change")}),help_lettersSwitch.removeEventListener("change",function(){}),help_lettersSwitch.addEventListener("change",function(e,t){Ti.API.info("app:Switch value: "+help_lettersSwitch.value),Ti.App.fireEvent("help_lettersSwitch_change"),t=help_lettersSwitch.value}),CheckEmailaddress(),""==aTextField.value&&(aTextField.value="Set a default email"),view.add(txtViewDesc),view.show();var copy="";Ti.include("newtext.js"),btnChoosePhoto.removeEventListener("click",function(){}),btnChoosePhoto.addEventListener("click",function(){Titanium.Media.openPhotoGallery({success:function(e){Ti.API.debug("Our type was: "+e.mediaType),e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO&&(image=e.media,saveBackgroundImage(image))},cancel:function(){},error:function(e){Ti.API.error(e)},mediaTypes:[Ti.Media.MEDIA_TYPE_PHOTO]})}),btnTakePhoto.removeEventListener("click",function(){}),btnTakePhoto.addEventListener("click",function(){Titanium.Media.showCamera({success:function(e){var t=e.media;e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO&&(Ti.App.Properties.setString("image",t.nativePath),saveBackgroundImage(t))},cancel:function(){},error:function(e){var t=Titanium.UI.createAlertDialog({title:"Camera"});e.code==Titanium.Media.NO_CAMERA?t.setMessage("Device does not have camera"):t.setMessage("Unexpected error: "+e.code),t.show()},allowImageEditing:!0,saveToPhotoGallery:!0})});